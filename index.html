<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="./style.css">

    <title>Document</title>
</head>
<body>
    <div class="magic">
        <h1>Welcome to my app</h1>
    </div>
    

    <div class="form_login">
        <label for="email_log">email:</label>
        <input type="text" name="email_log" id="email">
        <br>
        <label for="pwlog">password</label>
        <input type="text" name="" id="password">
        <button onclick="signin()">Login now</button>
    </div>
    

    <a href="register.html"><img src="./reg.png" alt=""></a>
    

    <script>
        magic = document.querySelector('.magic');
        document.addEventListener('DOMContentLoaded', (e)=>{
            setTimeout((e) => {
                magic.classList.add('display-none');
            }, 2000);
        })
    </script>

    <script>
        function signin(){
            var email = document.getElementById("email").value;
            var password = document.getElementById("password").value;
            admin.signInWithEmailAndPassword(email, password).then((cred) => {
                console.log(cred.user);
                var docRef = db.collection("users").doc(cred.user.uid);

                docRef.get().then((doc) => {
                    if (doc.exists) {
                        console.log("Document data:", doc.data());
                        if(doc.data().role=='admin'){
                            window.open('admin.html', '_self');
                        }else{
                            window.open('home.html', '_self');
                        }
                    } else {
                        // doc.data() will be undefined in this case
                        console.log("No such document!");
                    }
                }).catch((error) => {
                    console.log("Error getting document:", error);
                });





            })
        }
    </script>
  
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
        https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-analytics.js"></script>

    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>

    <script>
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        var firebaseConfig = {
          apiKey: "AIzaSyDvGItZ9Pht2Jh9oWHHcIJVnNrJkjA_1Sk",
          authDomain: "mobileapphw1.firebaseapp.com",
          projectId: "mobileapphw1",
          storageBucket: "mobileapphw1.appspot.com",
          messagingSenderId: "29599921082",
          appId: "1:29599921082:web:d66e1cedef4d1dcb616383",
          measurementId: "G-CWNCR6SRP5"
        };
   
    firebase.initializeApp(firebaseConfig);
    const admin = firebase.auth();
    const db = firebase.firestore();
    </script>
</body>
</html>